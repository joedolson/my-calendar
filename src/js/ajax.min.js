(()=>{(function(e){e(function(){e(".mc_response").hide(),e(".instance-list").on("click","button.delete_occurrence",function(){let t=e(this).attr("data-value"),n=e(this).attr("data-event"),a=e(this).attr("data-begin"),i=e(this).attr("data-end"),c={action:mc_data.action,occur_id:t,event_id:n,occur_begin:a,occur_end:i,security:mc_data.security};e.post(ajaxurl,c,function(d){d.success==1&&e("button[data-value='"+t+"']").parents("li").hide(),e(".mc_response").text(d.response).show(300)},"json")}),e(".mc_add_new").hide(),e("button.edit_occurrence").on("click",function(){let t=e(this).attr("aria-pressed"),n=e("button.save-occurrence").is(":visible");if(t=="true")e(this).removeAttr("aria-pressed");else{e(this).attr("aria-pressed","true"),e("button.edit_occurrence").not(this).removeAttr("aria-pressed"),e("#r_time").trigger("focus"),e(".save-occurrence").text("Edit Date");let a=e(this).data("value"),i=e(this).data("begin").split(" "),c=e(this).data("end").split(" ");e('input[name="r_instance"]').val(a),e("#r_time").val(i[1]),e("#r_begin").val(i[0]),e("#r_endtime").val(c[1]),e("#r_end").val(c[0])}n||e(".mc_add_new").toggle()}),e("button.add-occurrence").on("click",function(){let t=e(this).attr("aria-expanded");e('input[name="r_instance"]').val(""),t=="true"?(e(this).attr("aria-expanded","false").find(".dashicons").addClass("dashicons-plus").removeClass("dashicons-minus"),e(this).attr("data-action","shiftback"),e(".save-occurrence").text("Add Date")):(e(this).attr("aria-expanded","true").find(".dashicons").addClass("dashicons-minus").removeClass("dashicons-plus"),e(this).attr("data-action","")),e(".mc_add_new").toggle()}),e("button.save-occurrence").on("click",function(){let t=e("#r_begin").val(),n=e("#r_time").val(),a=e("#r_endtime").val(),i=e("#r_enddate").val(),c=e('input[name="event_id"]').val(),d=e('input[name="event_group_id"]').val(),l=e('input[name="r_instance"]').val(),_={action:mc_data.recur,event_id:c,group_id:d,event_date:t,event_time:n,event_endtime:a,event_enddate:i,event_instance:l,security:mc_data.security};e.post(ajaxurl,_,function(s){if(s.success==1){let o=n.split(":"),u=o[0]+":"+o[1],v=mc_data.url+s.id,p=typeof i>"u"?t:i;l?e(".instance-list").append('<li class="new"><p><span id="occur_date_'+s.id+'"><strong>Edited:</strong> '+t+" @ "+u+"</span></p></li>"):e(".instance-list").append('<li class="new"><p><span id="occur_date_'+s.id+'"><strong>Added:</strong> '+t+" @ "+u+'</span></p><p class="instance-buttons"><button class="button delete_occurrence" type="button" data-event="'+c+'" data-begin="'+t+" "+n+'" data-end="'+p+" "+a+'" data-value="'+s.id+'" aria-describedby="occur_date_'+s.id+'">Delete</button> <a href="'+v+'" class="button">Edit</a></p></li>')}e(".mc_response").text(s.response).show(300)},"json")}),e("#e_recur, #e_every").on("change",function(){let t=e("#e_recur").val(),n=e("#e_every").val(),a=e("duet-date-picker[identifier=e_repeats]").val(),i={action:mc_recur.action,until:a,every:n,recur:t,security:mc_recur.security};e.post(ajaxurl,i,function(c){c.response===""?(e(".mc_recur_string").removeClass("active"),e(".mc_recur_string p").text("")):(e(".mc_recur_string").addClass("active"),e(".mc_recur_string p").text(c.response).show(300))},"json")});let r=document.querySelector("duet-date-picker[identifier=e_repeats]");r!==null&&r.addEventListener("duetChange",function(t){let n=t.detail.value,a=e("#e_recur").val(),i=e("#e_every").val(),c={action:mc_recur.action,until:n,every:i,recur:a,security:mc_recur.security};e.post(ajaxurl,c,function(d){e(".mc_recur_string").addClass("active"),e(".mc_recur_string p").text(d.response).show(300)},"json")})}),e(function(){e("button.add-category").on("click",function(){let r=e("#event_category_name").val();if(r!==""){let t={action:mc_cats.action,category_name:r,security:mc_cats.security};e.post(ajaxurl,t,function(n){if(n.success==1){let a=n.category_id;e("#event_category_name").val(""),e('<li class="new"><input type="checkbox" name="event_category[]" id="mc_cat_'+a+'" value="'+a+'" checked> <label for="mc_cat_'+a+'">'+r+"</label></li>").insertBefore(".categories .event-new-category"),e("#e_category").append('<option value="'+a+'">'+r+"</option>")}},"json")}})})})(jQuery);})();
