(()=>{function P(e){e.height=e.contentWindow.document.body.scrollHeight+"px"}jQuery(document).ready(function(e){e("#my-calendar").on("submit",function(t){e("#mc_unsubmitted").remove()});let v=document.getElementById("my-calendar");if(v){let t=[],i=[],s=v.querySelectorAll("input, select");s.forEach(a=>{let d=a.value;a.addEventListener("keydown",function(l){s.forEach(y=>{d=y.value,i.push(d)});let h=t.slice().sort(),c=i.slice().sort(),n=g(h,c),m=document.getElementById("mc_unsubmitted");!n&&!m&&(m=document.createElement("div"),m.id="mc_unsubmitted",v.appendChild(m))}),t.push(d)})}function g(t,i){t.length===i.length&&t.every(function(s,a){return s===i[a]})}e(".preview-link").hide();let o=e(".preview-link").attr("data-css");e("#mc_css_file").on("change",function(t){let i=e(this).val();if(i!==o){let s=e(".preview-link").prop("href"),a=e(".preview-link").attr("data-css"),d=s.replace(a,i);e(".preview-link").prop("href",d).attr("data-css",i).show()}}),e("#e_schedule").on("click",".add_field",function(){e(".event_span").show();let t=e(".datetime-template").length,i=new Number(t+1),s=e("#event"+t).clone().attr("id","event"+i);e(s).find("input").prop("disabled",!1),e(s).find("button.restore_field").removeClass("restore_field").addClass("del_field").text(mcAdmin.deleteButton);let a=e("#event"+t);e("#event1").hide(),s.find(".number_of").text(t),e("#event"+t).after(s);let d=s.find("input"),l=s.find(".event-time"),h=s.find(".event-begin"),c=s.find(".event-end"),n=e("#mc_event_time").val(),m=e("#mc_event_endtime").val(),y=a.find(".event-begin").val();y||(y=document.querySelector('[identifier="mc_event_date"]').value),m||(m=document.querySelector('[identifier="mc_event_enddate"]').value),c.val(m),h.val(y),l.val(n).trigger("focus");let D=s.find("label");d.each(function(){let I=e(this).attr("id");newId=I+i,e(this).attr("id",newId).prop("disabled",!1)}),D.each(function(){let I=e(this).attr("for");newFor=I+i,e(this).attr("for",newFor)}),i==40&&e(".add_field").attr("disabled","disabled")}),e("#e_schedule").on("click",".del_field",function(){let t=e(this).parents("li").attr("id");e("#"+t+" input").prop("disabled",!0).removeClass("enabled").addClass("disabled"),e(".add_field").prop("disabled",!1),e(this).removeClass("del_field").addClass("restore_field").removeClass("button-delete").text(mcAdmin.restoreButton),e("#"+t).find(".remove_field").removeClass("hidden"),e(this).parents("div").addClass("multiple")}),e("#e_schedule").on("click",".remove_field",function(){let t=e(".datetime-template.enabled").length;e(this).parents("div").removeClass("multiple"),e(this).parents("li").remove(),t-1<=1&&(e(".event_span").hide(),e("#event1, #event1 .buttons").show())}),e("#e_schedule").on("click",".restore_field",function(){let t=e(this).parents("li").attr("id");e(this).parents("div").removeClass("multiple"),e(this).removeClass("restore_field").addClass("del_field button-delete").text(mcAdmin.deleteButton),e("#"+t).find(".remove_field").addClass("hidden"),e("#"+t+" input").prop("disabled",!1).removeClass("disabled").addClass("emabled")});let r=e(".disable-recurrences");r.find("fieldset").hide(),r.find("fieldset input, fieldset select, fieldset duet-date-picker").prop("disabled",!0),e(".enable-repetition").on("click",function(){e(this).attr("aria-expanded")!=="false"?(e(this).attr("aria-expanded","false"),e(this).find(".dashicons").removeClass("dashicons-arrow-down").addClass("dashicons-arrow-right"),r.find("fieldset").hide(),r.find("fieldset input, fieldset select, fieldset duet-date-picker").prop("disabled",!0)):(e(this).attr("aria-expanded","true"),e(this).find(".dashicons").removeClass("dashicons-arrow-right").addClass("dashicons-arrow-down"),r.find("fieldset").show(),r.find("fieldset input, fieldset select, fieldset duet-date-picker").prop("disabled",!1))}),e("#e_schedule").on("change","input",function(){r.find("fieldset").show(),r.find(".enable-repetition").attr("aria-expanded","true"),r.find(".enable-repetition .dashicons").addClass("dashicons-arrow-down").removeClass("dashicons-arrow-right"),r.find("fieldset input, fieldset select, fieldset duet-date-picker").prop("disabled",!1)});let p=document.querySelector(".add-location");if(p!==null){let t=document.getElementById("l_preset"),i=document.getElementById("preset_l"),s=t.value,a=i?i.value:"",d=p.getAttribute("aria-controls"),l=document.getElementById(d);l.classList.add("hidden"),p.addEventListener("click",function(h){this.getAttribute("aria-expanded")==="true"?(t.value=s,i.value=a,l.classList.add("hidden"),this.setAttribute("aria-expanded","false"),this.firstChild.classList.add("dashicons-plus"),this.firstChild.classList.remove("dashicons-minus")):(t.value="none",i.value="",l.classList.remove("hidden"),this.setAttribute("aria-expanded","true"),this.firstChild.classList.add("dashicons-minus"),this.firstChild.classList.remove("dashicons-plus"))})}let w=document.querySelector(".toggle-inside");if(w!==null){let i=w.parentNode.parentNode.querySelector(".inside");i.classList.add("hidden"),w.addEventListener("click",function(s){this.getAttribute("aria-expanded")==="true"?(i.classList.add("hidden"),this.setAttribute("aria-expanded","false"),this.firstChild.classList.add("dashicons-plus"),this.firstChild.classList.remove("dashicons-minus")):(i.classList.remove("hidden"),this.setAttribute("aria-expanded","true"),this.firstChild.classList.add("dashicons-minus"),this.firstChild.classList.remove("dashicons-plus"))})}let C=document.querySelector(".toggle-dates");if(C!==null){let t=document.getElementById("mc-view-scheduled-dates"),i=document.getElementById("my-calendar"),s=document.querySelectorAll(".button-primary");t.classList.add("hidden"),C.addEventListener("click",function(a){this.getAttribute("aria-expanded")==="true"?(this.setAttribute("data-action",""),i.classList.remove("disabled"),s.forEach(l=>{l.disabled=!1}),t.classList.add("hidden"),this.setAttribute("aria-expanded","false"),this.firstChild.classList.add("dashicons-arrow-right"),this.firstChild.classList.remove("dashicons-arrow-down")):(this.setAttribute("data-action","shiftforward"),s.forEach(l=>{l.disabled=!0}),i.classList.add("disabled"),t.classList.remove("hidden"),this.setAttribute("aria-expanded","true"),this.firstChild.classList.add("dashicons-arrow-down"),this.firstChild.classList.remove("dashicons-arrow-right"))})}e(document).on("keydown","#mc-scheduled-dates button",function(t){let i=t.keyCode?t.keyCode:t.which,s=e(":focus").attr("data-action");!t.shiftKey&&i==9&&s=="shiftback"&&(t.preventDefault(),e(".toggle-dates").trigger("focus")),t.shiftKey&&i==9&&s=="shiftforward"&&(t.preventDefault(),e("[data-action=shiftback]").trigger("focus"))}),e(".event_span").hide(),e('.mc-actions input[type="submit"]').attr("disabled","disabled"),e("#mass_replace_on").on("click",function(){e(this).prop("checked")?e(".mass-replace-container").show():e(".mass-replace-container").hide()}),e(".selectall").on("click",function(){let t=e(this).prop("checked");t?e('.mc-actions input[type="submit"]').removeAttr("disabled"):e('.mc-actions input[type="submit"]').attr("disabled","disabled");let i=e(this).attr("data-action");e('input[name="'+i+'[]"]').each(function(){e(this).prop("checked",t)})}),e(".row-actions").on("focus","a",function(){e(this).parent(".row-actions").css({left:"auto"})}),e(".row-actions").on("blur","a",function(){e(this).parent(".row-actions").css({left:"-999em"})}),e("#mc_bulk_actions").on("change",function(t){let i=e(this).val();e("#mc_bulk_actions_footer").val(i)}),e("#mc_bulk_actions_footer").on("change",function(t){let i=e(this).val();e("#mc_bulk_actions").val(i)}),e("#my-calendar-admin-table input, .mc-actions input:not(#mass_replace_on)").on("change",function(t){let i=e("#my-calendar-admin-table input:checked"),s=e(this).prop("checked"),a=e(this).parents("table").hasClass("mc-groups-table"),d=i.length;s?(a&&d>1||!a)&&(e('.mc-actions input[type="submit"]').removeAttr("disabled"),e(".mc-actions #mass_replace_on").removeAttr("disabled")):(a&&d<2||!a&&d==0)&&(e('.mc-actions input[type="submit"]').attr("disabled","disabled"),e(".mc-actions #mass_replace_on").attr("disabled","disabled"))});let u=e(".new-event-category");u.hide(),e("#event_category_new").prop("checked",!1);let _=e("label[for=event_category_new]");_.find(".dashicons-minus").hide(),e("#event_category_new").on("click",function(){e(this).prop("checked")?(u.show(),e("#event_category_name").prop("disabled",!1),_.find(".dashicons").addClass("dashicons-minus").removeClass("dashicons-plus")):(u.hide(),e("#event_category_name").prop("disabled",!0),_.find(".dashicons").addClass("dashicons-plus").removeClass("dashicons-minus"))});let f=e(".mc-primary-category"),k=e(".categories input:checked");k.length<=1&&f.hide(),k.each(function(){let t=e(this).val();f.find("select").find("option[value="+t+"]").show()}),e(".categories input").on("change",function(t){let i=e(".categories input:checked"),s=e(".categories input");i.length>1?f.show().prop("disabled",!1):f.hide().prop("disabled",!0),s.each(function(){let a=e(this).val(),d=e(this).prop("checked"),l=f.find("select");d?l.find("option[value="+a+"]").show().prop("disabled",!1):l.find("option[value="+a+"]").hide().prop("disabled",!0)})}),e(".fifth-week-schedule").hide(),e("#e_recur").on("change",function(t){let i=e(this).val();i!="S"?e("duet-date-picker[identifier=e_repeats]").attr("required","true"):e("duet-date-picker[identifier=e_repeats]").removeAttr("required"),i=="U"?(e("#e_every").attr("max",1).val(1),e(".fifth-week-schedule").show()):(e("#e_every").attr("max",99),e(".fifth-week-schedule").hide())}),e('input[id="e_allday"]').prop("checked")||e(".event_time_label").hide(),e('input[id="e_allday"]').change(function(){e(this).prop("checked")?e(".event_time_label").show():e(".event_time_label").hide()}),e('input[id="mc_remote"]').prop("checked")||e(".mc_remote_info").hide(),e('input[id="mc_remote"]').change(function(){e(this).prop("checked")?e(".mc_remote_info").show():e(".mc_remote_info").hide()}),e('input[id="mc_display_single-gmap"]').prop("checked")&&e("#mc_gmap_api_key").attr("required","true"),e('input[id="mc_display_single-gmap"]').change(function(){e(this).prop("checked")?e("#mc_gmap_api_key").attr("required","true"):e("#mc_gmap_api_key").removeAttr("required")}),e('input[id="e_hide_end"]').prop("checked")&&e("label[for=mc_event_endtime] span").show(),e('input[id="e_hide_end"]').change(function(){e(this).prop("checked")?e("label[for=mc_event_endtime] span").show():e("label[for=mc_event_endtime] span").hide()});let A=window.location.hash,E=document.querySelectorAll(".mc-tabs");for(let t=0;t<E.length;t++)e(E[t]).find(A).length!==0?S(A):(A=e(E[t]).find("[role=tablist]").attr("data-default"),S("#"+A));let q=document.querySelectorAll(".mc-tabs [role=tab]");for(let t=0;t<q.length;t++)q[t].addEventListener("click",T),q[t].addEventListener("keydown",B);function T(t){let s=e(t.currentTarget).closest(".tabs").find("[role=tab]"),a=e(t.currentTarget).closest(".mc-tabs"),d=e(t.currentTarget).parents(".inside"),l=t.target.getAttribute("aria-controls"),h=e("iframe.mc-iframe"),c=[];d.length==0&&!a.hasClass("mcs-tabs")?c=a.find(".ui-sortable > [role=tabpanel]"):c=a.find("[role=tabpanel]");for(let n=0;n<s.length;n++)s[n].setAttribute("aria-selected","false");t.target.setAttribute("aria-selected","true");for(let n=0;n<c.length;n++)c[n].setAttribute("aria-hidden","true");d.length==0&&(window.location.hash=l),document.getElementById(l).setAttribute("aria-hidden","false");for(let n=0;n<h.length;n++){let m=h[n];P(m)}e("#"+l).attr("tabindex","-1").trigger("focus"),window.scrollTo(0,0)}function S(t){let i=t.replace("#",""),s=e("button[aria-controls="+i+"]"),d=e(t).closest(".tabs").find("[role=tab]"),h=e(t).closest(".mc-tabs").find("[role=tabpanel]"),c=document.getElementById(i);for(let n=0;n<d.length;n++)d[n].setAttribute("aria-selected","false");s.attr("aria-selected","true");for(let n=0;n<h.length;n++)h[n].setAttribute("aria-hidden","true");c!==null&&c.setAttribute("aria-hidden","false")}function B(t){t.keyCode==37&&(e(t.currentTarget).prev().trigger("click").trigger("focus"),t.preventDefault()),t.keyCode==38&&(e(t.currentTarget).prev().trigger("click").trigger("focus"),t.preventDefault()),t.keyCode==39&&(e(t.currentTarget).next().trigger("click").trigger("focus"),t.preventDefault()),t.keyCode==40&&(e(t.currentTarget).next().trigger("click").trigger("focus"),t.preventDefault())}e("#mc-generator .custom").hide(),e("#mc-generator select[name=type]").on("change",function(){e(this).val()=="custom"?e("#mc-generator .custom").show():e("#mc-generator .custom").hide()}),e("#my-calendar-generate select[name=ltype]").on("change",function(t){e(this).val()!=""?e("#mc-generator input[name=lvalue]").prop("disabled",!1).prop("required",!0):e("#mc-generator input[name=lvalue]").prop("disabled",!0).prop("required",!1)}),e(".mc-sortable").sortable({placeholder:"mc-ui-state-highlight",update:function(t,i){e(".mc-sortable-update").html("Submit form to save changes")}}),e(".mc-sortable .hide").on("click",function(t){let i=e(this).find(".dashicons").hasClass("dashicons-hidden"),s=e(this).parents("li");i?(s.removeClass("mc-hidden").addClass("mc-visible"),s.find("input[type=hidden]").prop("disabled",!1),e(this).find(".dashicons").removeClass("dashicons-hidden").addClass("dashicons-visibility"),wp.a11y.speak("Item shown")):(s.addClass("mc-hidden").removeClass("mc-visible"),s.find("input[type=hidden]").prop("disabled",!0),e(this).find(".dashicons").removeClass("dashicons-visibility").addClass("dashicons-hidden"),wp.a11y.speak("Item hidden"))}),e(".mc-sortable .up").on("click",function(t){let i=e(this).parents().map(function(){return this.tagName}).get(),s=e.inArray("LI",i),a=e.inArray("TR",i);s==1?(e(this).parents("li").insertBefore(e(this).parents("li").prev()),e(".mc-sortable li").removeClass("mc-updated"),e(this).parents("li").addClass("mc-updated")):a==1?(e(this).parents("tr").insertBefore(e(this).parents("tr").prev()),e(".mc-sortable tr").removeClass("mc-updated"),e(this).parents("tr").addClass("mc-updated")):(e(this).parents(".mc-row").insertBefore(e(this).parents(".mc-row").prev()),e(".mc-sortable .mc-row").removeClass("mc-updated"),e(this).parents(".mc-row").addClass("mc-updated")),e(this).trigger("focus"),wp.a11y.speak("Item moved up")}),e(".mc-sortable .down").on("click",function(t){let i=e(this).parents().map(function(){return this.tagName}).get(),s=e.inArray("LI",i),a=e.inArray("TR",i);s==1?(e(this).parents("li").insertAfter(e(this).parents("li").next()),e(".mc-sortable li").removeClass("mc-updated"),e(this).parents("li").addClass("mc-updated")):a==1?(e(this).parents("tr").insertAfter(e(this).parents("tr").next()),e(".mc-sortable tr").removeClass("mc-updated"),e(this).parents("tr").addClass("mc-updated")):(e(this).parents(".mc-row").insertAfter(e(this).parents(".mc-row").next()),e(".mc-sortable .mc-row").removeClass("mc-updated"),e(this).parents(".mc-row").addClass("mc-updated")),e(this).trigger("focus"),wp.a11y.speak("Item moved down")})});var b="";(function(e){"use strict";e(function(){function v(){typeof b!="string"&&(b.detach(),b="")}e(".mc-image-upload").on("click",".remove-image",function(g){let o=e(this).data("context"),r=o.substr(0,1);e("#"+r+"_image_id").val(""),e("#"+r+"_image").val(""),e("#"+o+"_image").attr("src","").attr("alt",""),e(".event_image").text(mcAdmin.imageRemoved)}),e(".mc-image-upload").on("click",".select-image",function(g){let r=e(this).data("context").substr(0,1);g.preventDefault();let p=document.querySelector("#"+r+"_image"),w=document.querySelector("#"+r+"_image_id"),C=document.querySelector(".event_image");v(),b=wp.media({multiple:!1,title:mcAdmin.modalTitle,button:{text:mcAdmin.buttonName}}),b.on("select",function(){let u=b.state().get("selection"),_="",f="",k="",x="",L="";u&&(_=u.first().attributes.id,k=mcAdmin.thumbHeight,x=Math.round(u.first().attributes.width/u.first().attributes.height*k),L=u.first().attributes.alt,f="<img id='event_image' src='"+u.first().attributes.url+"' width='"+x+"' height='"+k+"' alt='"+L+"' />",p.value=u.first().attributes.url,w.value=_,C.innerHTML=f)}),b.open()})}),mcAdmin.mcs<2.1&&e(".mcs-tabs").each(function(v){let g=e(".mcs-tabs .wptab").length,o=window.location.hash;o||(o="#"+e(".mcs-tabs .wptab:nth-of-type(1)").attr("id")),e('.mcs-tabs .tabs a[href="'+o+'"]').addClass("active").attr("aria-selected","true"),g>1&&(e(".mcs-tabs .wptab").not(o).attr("aria-hidden","true"),e(".mcs-tabs .wptab").removeClass("initial-hidden"),e(o).show(),e(".mcs-tabs .tabs a").on("click",function(r){r.preventDefault(),e(".mcs-tabs .tabs a").removeClass("active").attr("aria-selected","false"),e(this).addClass("active").attr("aria-selected","true");let p=e(this).attr("href");window.location.hash=p,e(".mcs-tabs .wptab").not(p).attr("aria-hidden","true"),e(p).removeAttr("aria-hidden").show().trigger("focus")}))})})(jQuery);})();
