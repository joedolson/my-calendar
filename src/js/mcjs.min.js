(()=>{(()=>{let{__:f,_x:H,_n:M,_nx:I}=wp.i18n;S(),h();function h(l=!1){let e=document.querySelectorAll(".mc-main, .mc-event-list");e&&e.forEach(a=>{let n=l||a.getAttribute("id");P(n),a.classList.remove("mcjs")})}let g=document.querySelectorAll(".mc-loader");g&&g.forEach(l=>{let e=l.closest("ul");e.setAttribute("tabindex","-1"),e.addEventListener("click",function(a){let n=a.target.closest("button");n&&n.classList.contains("mc-loader")&&x(n,e)})});function x(l,e){let a=new XMLHttpRequest;a.open("POST",my_calendar.ajaxurl,!0),a.setRequestHeader("Content-Type","application/x-www-form-urlencoded;"),a.onload=function(){if(this.status>=200&&this.status<400){let r=JSON.parse(this.response);e.querySelectorAll("li").forEach(t=>t.remove()),e.innerHTML+=r.response,e.focus(),wp.a11y.speak(f("Upcoming events loaded","my-calendar"))}else e.innerHTML+="<li>"+f("Upcoming Events failed to load","my-calendar")+"</li>",wp.a11y.speak(f("Upcoming Events failed to load","my-calendar"))},a.onerror=function(){};let n=l.value,s=l.getAttribute("data-value");type=n==="dates"?"dates":"time",a.send("action="+my_calendar.action+"&behavior=loadupcoming&"+type+"="+n+"&args="+s)}q(),w(),my_calendar.ajax==="true"?A():v();function A(){document.querySelectorAll(".my-calendar-header a:not(.mc-print a, .mc-export a), .my-calendar-footer a:not(.mc-print a, .mc-export a), .my-calendar-header input[type=submit], .my-calendar-footer input[type=submit], .my-calendar-header button:not(.mc-export button), .my-calendar-footer button:not(.mc-export button)").forEach(e=>{e.addEventListener("click",function(a){_(a,e)}),e.addEventListener("keyup",function(a){_(a,e)})})}function _(l,e){if(l.preventDefault(),l.type==="click"||l.type==="keyup"&&l.key===" "){let a=e.closest(".mc-main");a.classList.remove("is-main-view");let n=e.getAttribute("id"),s=a.getAttribute("id"),r,t,d,u,m,y,b,p,c,o,E;if(e.nodeName==="INPUT"||e.nodeName==="BUTTON")if(o=e.closest("form"),o){if(o.classList.contains("mc-date-switcher")){r=o.querySelector("select[name=month]").value;let i=o.querySelector("select[name=dy]");i&&(t=i.value),d=o.querySelector("select[name=yr]").value}o.classList.contains("mc-categories-switcher")&&(u=o.querySelector("select[name=mcat]").value),o.classList.contains("mc-locations-switcher")&&(m=o.querySelector("select[name=loc]").value),o.classList.contains("mc-access-switcher")&&(y=o.querySelector("select[name=access]").value),o.classList.contains("mc-search-form")&&(b=o.querySelector("input[name=mcs]").value),p=e.closest("form").getAttribute("action")}else p=e.getAttribute("data-href");try{c=new URL(p),c.searchParams.delete("embed"),c.searchParams.delete("source"),(e.nodeName==="INPUT"||e.nodeName==="BUTTON")&&(o=e.closest("form"),o&&(c.searchParams.delete("month"),c.searchParams.delete("dy"),c.searchParams.delete("yr"),r!==""&&typeof r<"u"&&(c.searchParams.append("month",parseInt(r)),typeof t<"u"&&c.searchParams.append("dy",parseInt(t)),c.searchParams.append("yr",parseInt(d))),c.searchParams.delete("mcat"),u!==""&&typeof u<"u"&&c.searchParams.append("mcat",u),c.searchParams.delete("loc"),c.searchParams.delete("ltype"),m!==""&&typeof m<"u"&&(c.searchParams.append("ltype","id"),c.searchParams.append("loc",m)),c.searchParams.delete("access"),y!==""&&typeof y<"u"&&y!=="all"&&c.searchParams.append("access",parseInt(y)),c.searchParams.delete("mcs"),b!==""&&typeof b<"u"&&c.searchParams.append("mcs",encodeURIComponent(b)),p=c.toString())),E=c.searchParams,E.sort(),window.history.pushState({},"",c)}catch(i){c=!1}a.insertAdjacentHTML("afterbegin",'<div class="mc-loading"></div><div class="loading"><span class="screen-reader-text">Loading...</span></div>'),wp.a11y.speak(f("Loading","my-calendar")),fetch(p).then(i=>{if(i.ok)return i.text()}).then(i=>{let T=new DOMParser().parseFromString(i,"text/html");a.replaceWith(T.querySelector("#"+s)),k(n,s)}).catch(i=>{a.insertAdjacentHTML("afterbegin",i)})}}function k(l,e){if(h(e),typeof my_calendar<"u"&&my_calendar.list=="true"){let s;my_calendar.links==="false"?(s=document.querySelectorAll("li.mc-events"),s.forEach(r=>{let t=r.querySelector(".mc-events");!r.classList.contains("current-day")&&t&&(t.style.display="none")})):(s=document.querySelectorAll("li.mc-events .single-details"),s.forEach(r=>{r.style.display="none"}))}typeof my_calendar<"u"&&my_calendar.grid=="true"&&document.querySelectorAll(".mc-main.calendar .has-events > .calendar-event > *:not(header)").forEach(r=>{r.style.display="none"}),typeof my_calendar<"u"&&my_calendar.mini=="true"&&document.querySelectorAll(".mc-main.mini .has-events .calendar-events").forEach(r=>{r.style.display="none"}),q(),w();let a=document.getElementById(l);console.log(a),a===null&&(calendar=document.getElementById(e),a=calendar.querySelectorAll("button")[0]),a.focus();let n=document.getElementById("mc_head_"+e);wp.a11y.speak(n.innerText),S(),my_calendar.ajax==="true"?A():v(),L()}function S(){let l=document.querySelectorAll(".mc-user-time"),e=new Intl.DateTimeFormat().resolvedOptions().timeZone,a,n;l.forEach(s=>{let r=s.innerText,t=s.getAttribute("data-type");e===void 0&&(e=s.getAttribute("data-label")),t==="datetime"&&(n='<span class="mc-local-time-time">'+new Date(r).toLocaleTimeString().replace(":00 "," ")+"</span>",a='<span class="mc-local-time-date">'+new Date(r).toLocaleDateString()+"</span>",s.innerHTML='<span class="mc-local-time-label">'+e+":</span> "+a+'<span class="sep">, </span>'+n),t==="date"&&(a='<span class="mc-local-time-date">'+new Date(r).toLocaleDateString()+"</span>",s.innerHTML='<span class="mc-local-time-label">'+e+":</span> "+a),t==="time"&&(n='<span class="mc-local-time-time">'+new Date(r).toLocaleTimeString().replace(":00 "," ")+"</span>",s.innerHTML='<span class="mc-local-time-label">'+e+":</span> "+n),s.setAttribute("data-time",r)})}function v(){document.querySelectorAll(".mc-main button.mc-navigation-button").forEach(e=>{var n;let a=document.createElement("a");a.setAttribute("id",e.getAttribute("id")),a.setAttribute("href",e.getAttribute("data-href")),classes=(n=e.getAttribute("class"))!=null?n:"",a.setAttribute("class",classes),a.setAttribute("rel","nofollow"),a.classList.remove("mc-navigation-button"),a.classList.add("mc-navigation-link"),a.innerHTML=e.innerHTML,e.replaceWith(a)})}function w(){let l=document.querySelectorAll("button.has-popup");l&&l.forEach(e=>{let a=e.getAttribute("aria-controls"),n=document.getElementById(a);n.style.display="none",e.addEventListener("click",function(){let s=n.checkVisibility(),r=e.offsetWidth+8;n.style.left=r+"px",s?(n.style.display="none",e.setAttribute("aria-expanded","false")):(n.style.display="block",e.setAttribute("aria-expanded","true"))})})}function P(l){let e,a;if(l){let n=document.querySelector("#"+l+" .mc-subscribe"),s=document.querySelector("#"+l+" .mc-download");if(n!==null&&(a=n.querySelector("button"),a===null)){let r="mc_control_"+Math.floor(Math.random()*1e3).toString(),t=document.createElement("button");t.setAttribute("type","button"),t.setAttribute("aria-controls",r),t.setAttribute("aria-expanded",!1),t.innerHTML=my_calendar.subscribe+' <span class="dashicons dashicons-arrow-right" aria-hidden="true"></span>',n.querySelector("ul").setAttribute("id",r),n.querySelector("ul").style.display="none",n.insertAdjacentElement("afterbegin",t)}if(s!==null&&(e=s.querySelector("button"),e===null)){let r="mc_control_"+Math.floor(Math.random()*1e3).toString(),t=document.createElement("button");t.setAttribute("type","button"),t.setAttribute("aria-controls",r),t.setAttribute("aria-expanded",!1),t.innerHTML=my_calendar.export+' <span class="dashicons dashicons-arrow-right" aria-hidden="true"></span>',s.querySelector("ul").setAttribute("id",r),s.querySelector("ul").style.display="none",s.insertAdjacentElement("afterbegin",t)}if(e===null||a===null){let r=document.querySelectorAll("#"+l+" .mc-export button"),t;r.forEach(d=>{d.addEventListener("click",function(){let u=d.getAttribute("aria-controls"),m=document.getElementById(u);m&&(m.checkVisibility()?(m.style.display="none",d.setAttribute("aria-expanded","false"),t=d.querySelector(".dashicons"),t.classList.remove("dashicons-arrow-down"),t.classList.add("dashicons-arrow-right")):(m.style.display="block",d.setAttribute("aria-expanded","true"),t=d.querySelector(".dashicons"),t.classList.remove("dashicons-arrow-right"),t.classList.add("dashicons-arrow-down")))})})}}}function q(){document.querySelectorAll(".mc-main a[target=_blank]").forEach(e=>{e.classList.add("mc-opens-in-new-tab"),e.insertAdjacentHTML("beforeend",' <span class="dashicons dashicons-external" aria-hidden="true"></span><span class="screen-reader-text"> '+my_calendar.newWindow+"</span>")})}function L(){try{let l=document.querySelectorAll(".mc-main.calendar table.my-calendar-table"),e=document.querySelectorAll(".mc-main.calendar table.my-calendar-table thead, .mc-main.calendar table.my-calendar-table tbody, .mc-main.calendar table.my-calendar-table tfoot"),a=document.querySelectorAll(".mc-main.calendar table.my-calendar-table tr"),n=document.querySelectorAll(".mc-main.calendar table.my-calendar-table td"),s=document.querySelectorAll(".mc-main.calendar table.my-calendar-table th"),r=document.querySelectorAll(".mc-main.calendar table.my-calendar-table th[scope=row]");for(let t=0;t<l.length;t++)l[t].setAttribute("role","table");for(let t=0;t<e.length;t++)e[t].setAttribute("role","rowgroup");for(let t=0;t<a.length;t++)a[t].setAttribute("role","row");for(let t=0;t<n.length;t++)n[t].setAttribute("role","cell");for(let t=0;t<s.length;t++)s[t].setAttribute("role","columnheader");for(let t=0;t<r.length;t++)r[t].setAttribute("role","rowheader")}catch(l){console.log("my_calendar_table_aria(): "+l)}}L()})();})();
