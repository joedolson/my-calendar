(()=>{(function(e){let{__:h,_x:S,_n:T,_nx:q}=wp.i18n;e(function(){g();let a=document.querySelectorAll(".mc-main, .mc-event-list");a&&a.forEach(n=>{let t=n.getAttribute("id");b(t),n.classList.remove("mcjs")})});let y=document.querySelectorAll(".mc-loader");y&&y.forEach(a=>{let n=a.closest("ul");n.setAttribute("tabindex","-1"),n.addEventListener("click",function(t){let i=t.target.closest("button");i&&i.classList.contains("mc-loader")&&k(i,n)})});function k(a,n){let t=new XMLHttpRequest;t.open("POST",my_calendar.ajaxurl,!0),t.setRequestHeader("Content-Type","application/x-www-form-urlencoded;"),t.onload=function(){if(this.status>=200&&this.status<400){let r=JSON.parse(this.response);n.querySelectorAll("li").forEach(s=>s.remove()),n.innerHTML+=r.response,console.log(r.response),n.focus(),wp.a11y.speak(h("Upcoming events loaded","my-calendar"))}else n.innerHTML+="<li>"+h("Upcoming Events failed to load","my-calendar")+"</li>",wp.a11y.speak(h("Upcoming Events failed to load","my-calendar"))},t.onerror=function(){};let i=a.value,l=a.getAttribute("data-value");type=i==="dates"?"dates":"time",t.send("action="+my_calendar.action+"&behavior=loadupcoming&"+type+"="+i+"&args="+l)}if(my_calendar.mini==="true"&&(e(".mini .calendar-events").hide(),e(document).on("click",".mini .has-events .trigger",function(a){a.preventDefault();let n=e(this).parents(".has-events").children(".calendar-events");n.toggle(),e(".mini .has-events").children(".trigger").removeClass("active-toggle"),e(".mini .has-events").children().not(".mc-date-container").not(n).hide(),e(this).addClass("active-toggle"),a.stopImmediatePropagation()}),e(document).on("click",".calendar-events .close",function(a){a.preventDefault(),e(this).closest(".mini .has-events").children(".trigger").removeClass("active-toggle"),e(this).closest("div.calendar-events").toggle(),a.stopImmediatePropagation()})),my_calendar.list==="true"&&my_calendar.links==="false"&&(e("li .list-event").hide(),e("li.current-day .list-event").show(),e("li.current-day .event-date .mc-text-button").attr("aria-expanded",!0),e(document).on("click",".event-date button",function(a){return a.preventDefault(),e(this).closest(".mc-events").find(".mc-event").toggle(),e(this).closest(".mc-events").find(".mc-event").is(":visible")?e(this).attr("aria-expanded","true"):e(this).attr("aria-expanded","false"),a.stopImmediatePropagation(),!1})),my_calendar.grid==="true"||my_calendar.list==="true"&&my_calendar.links==="true"){let a=my_calendar.grid==="true"?".calendar-event":".list-event",n=my_calendar.links==="true"&&my_calendar.grid==="true"?".mc-events":a;e(n+" .single-details").hide(),e(document).on("click",n+" .event-title .open",function(t){let i=e(this).parents(".mc-event").children(".details").is(":visible"),l=e(this).attr("aria-controls"),r=e("#"+l);i?e(this).attr("aria-expanded","false"):e(this).attr("aria-expanded","true"),t.preventDefault();let s=e(this).parents(".mc-event").children();e(this).closest(".mc-main").toggleClass("grid-open"),r.toggle();let d=s.find("a, object, :input, iframe, [tabindex]"),m=d.last();return d.first().attr("data-action","shiftforward"),m.attr("data-action","shiftback"),e(n).children(".single-details").not(s).hide(),t.stopImmediatePropagation(),!1}),e(document).on("click",".calendar-event .close",function(t){t.preventDefault(),e(this).parents(".mc-event").find("a.open").attr("aria-expanded","false"),e(this).closest(".mc-main").removeClass("grid-open"),e(this).closest(".mc-event").find(".event-title a").trigger("focus"),e(this).closest("div.single-details").toggle(),t.stopImmediatePropagation()}),e(document).on("keydown",function(t){(t.keyCode?t.keyCode:t.which)==27&&(e(".mc-main ").removeClass("grid-open"),e(".calendar-event div.single-details").hide(),e(".mini .calendar-events").hide())}),e(document).on("keydown",".mc-event a, .mc-event object, .mc-event :input, .mc-event iframe, .mc-event [tabindex]",function(t){let i=t.keyCode?t.keyCode:t.which,l=e(":focus").attr("data-action");!t.shiftKey&&i==9&&l=="shiftback"&&(t.preventDefault(),e("[data-action=shiftforward]").trigger("focus")),t.shiftKey&&i==9&&l=="shiftforward"&&(t.preventDefault(),e("[data-action=shiftback]").trigger("focus"))})}my_calendar.ajax==="true"&&(v(),_(),e(document).on("keydown",".my-calendar-header a:not(.mc-print a, .mc-export a), .my-calendar-footer a:not(.mc-print a, .mc-export a)",function(a){a.which===32&&a.preventDefault()}),e(document).on("click keyup",".my-calendar-header a:not(.mc-print a, .mc-export a), .my-calendar-footer a:not(.mc-print a, .mc-export a), .my-calendar-header input[type=submit], .my-calendar-footer input[type=submit], .my-calendar-header button:not(.mc-export button), .my-calendar-footer button:not(.mc-export button)",function(a){if(a.preventDefault(),a.type==="click"||a.type==="keyup"&&a.which===32){let n=e(this).attr("id"),t=e(this).closest(".mc-main"),i=t.attr("id"),l="",r="",s="",d="",m="",p="",f="",u="",c;if(this.nodeName==="INPUT"||this.nodeName==="BUTTON"){let o=e(this).parents("form");o.hasClass("mc-date-switcher")&&(l=o.find("select[name=month]").val(),r=o.find("select[name=dy]").val(),s=o.find("select[name=yr]").val()),o.hasClass("mc-categories-switcher")&&(d=o.find("select[name=mcat]").val()),o.hasClass("mc-locations-switcher")&&(m=o.find("select[name=loc]").val()),o.hasClass("mc-access-switcher")&&(p=o.find("select[name=access]").val()),f=o.find("input[name=mcs]").val(),u=e(this).attr("data-href")}else u=e(this).attr("href");try{c=new URL(u),c.searchParams.delete("embed"),c.searchParams.delete("source"),(this.nodeName==="INPUT"||this.nodeName==="BUTTON")&&(l!==""&&(c.searchParams.delete("month"),c.searchParams.delete("dy"),c.searchParams.delete("yr"),c.searchParams.append("month",parseInt(l)),typeof r<"u"&&c.searchParams.append("dy",parseInt(r)),c.searchParams.append("yr",parseInt(s))),d!==""&&(c.searchParams.delete("mcat"),c.searchParams.append("mcat",d)),m!==""&&(c.searchParams.delete("loc"),c.searchParams.delete("ltype"),c.searchParams.append("ltype","id"),c.searchParams.append("loc",m)),p!==""&&(c.searchParams.delete("access"),c.searchParams.append("access",parseInt(p))),c.searchParams.delete("mcs"),f!==""&&typeof f<"u"&&c.searchParams.append("mcs",encodeURIComponent(f)),u=c.toString()),window.history.pushState({},"",c)}catch(o){c=!1}let A=t.height();e("#"+i).html('<div class="mc-loading"></div><div class="loading" style="height:'+A+'px"><span class="screen-reader-text">Loading...</span></div>'),wp.a11y.speak(h("Loading","my-calendar")),e("#"+i).load(u+" #"+i+" > *",function(o,P,x){P=="error"&&e("#"+i).html(x.status+" "+x.statusText),typeof my_calendar<"u"&&my_calendar.list=="true"&&(my_calendar.links==="false"?(e("li.mc-events").find(".mc-events").hide(),e("li.current-day").children().show()):e("li.mc-events .single-details").hide()),typeof my_calendar<"u"&&my_calendar.grid=="true"&&e(".has-events > .calendar-event").children().not("header").hide(),typeof my_calendar<"u"&&my_calendar.mini=="true"&&e(".mini .has-events").children().not(".mc-date-container").hide(),v(),_(),e("#"+n).trigger("focus");let C=e("#mc_head_"+i).text();wp.a11y.speak(C),g(),b(n),w()})}}));function g(){let a=e(".mc-user-time"),n=Intl.DateTimeFormat().resolvedOptions().timeZone,t="",i="";a.each(function(){let l=e(this).text();n===void 0&&(n=e(this).attr("data-label")),l.replace("Z",".000Z")===new Date(l).toISOString()&&e(this).css({display:"none"}),i='<span class="mc-local-time-time">'+new Date(l).toLocaleTimeString().replace(":00 "," ")+"</span>",t='<span class="mc-local-time-date">'+new Date(l).toLocaleDateString()+"</span>",e(this).html('<span class="mc-local-time-label">'+n+":</span> "+t+'<span class="sep">, </span>'+i).attr("data-time",l)})}function v(){e(".my-calendar-header a:not(.mc-print a, .mc-export a), .my-calendar-footer a:not(.mc-print a, .mc-export a)").each(function(){e(this).attr("role","button")})}function b(a){if(a){let n=e("#"+a+" .mc-subscribe"),t=e("#"+a+" .mc-download");if(n.length>0){let l="mc_control_"+Math.floor(Math.random()*1e3).toString(),r=document.createElement("button");r.setAttribute("type","button"),r.setAttribute("aria-controls",l),r.setAttribute("aria-expanded",!1),r.innerHTML=my_calendar.subscribe+' <span class="dashicons dashicons-arrow-right" aria-hidden="true"></span>',n.find("ul").attr("id",l),n.find("ul").css({display:"none"}),n.prepend(r)}if(t.length>0){let l="mc_control_"+Math.floor(Math.random()*1e3).toString(),r=document.createElement("button");r.setAttribute("type","button"),r.setAttribute("aria-controls",l),r.setAttribute("aria-expanded",!1),r.innerHTML=my_calendar.export+' <span class="dashicons dashicons-arrow-right" aria-hidden="true"></span>',t.find("ul").attr("id",l),t.find("ul").css({display:"none"}),t.prepend(r)}e("#"+a+" .mc-export button").each(function(){e(this).on("click",function(){let l=e(this).attr("aria-controls"),r=e("#"+l);r.is(":visible")?(r.css({display:"none"}),e(this).attr("aria-expanded","false"),e(this).find(".dashicons").removeClass("dashicons-arrow-down").addClass("dashicons-arrow-right")):(r.css({display:"block"}),e(this).attr("aria-expanded","true"),e(this).find(".dashicons").removeClass("dashicons-arrow-right").addClass("dashicons-arrow-down"))})})}}e(".mc-main a[target=_blank]").append(' <span class="dashicons dashicons-external" aria-hidden="true"></span><span class="screen-reader-text"> '+my_calendar.newWindow+"</span>");function _(){let a=document.querySelectorAll(".mc-toggle-edit");a&&a.forEach(n=>{let t=n.getAttribute("aria-controls"),i=document.querySelector("#"+t);n.addEventListener("click",function(l){let r=n.offsetWidth+8;i.style.left=r+"px",n.getAttribute("aria-expanded")==="true"?(i.style.display="none",n.setAttribute("aria-expanded","false")):(i.style.display="block",n.setAttribute("aria-expanded","true"))})})}function w(){try{let a=document.querySelectorAll(".mc-main.calendar table.my-calendar-table"),n=document.querySelectorAll(".mc-main.calendar table.my-calendar-table thead, .mc-main.calendar table.my-calendar-table tbody, .mc-main.calendar table.my-calendar-table tfoot"),t=document.querySelectorAll(".mc-main.calendar table.my-calendar-table tr"),i=document.querySelectorAll(".mc-main.calendar table.my-calendar-table td"),l=document.querySelectorAll(".mc-main.calendar table.my-calendar-table th"),r=document.querySelectorAll(".mc-main.calendar table.my-calendar-table th[scope=row]");for(let s=0;s<a.length;s++)a[s].setAttribute("role","table");for(let s=0;s<n.length;s++)n[s].setAttribute("role","rowgroup");for(let s=0;s<t.length;s++)t[s].setAttribute("role","row");for(let s=0;s<i.length;s++)i[s].setAttribute("role","cell");for(let s=0;s<l.length;s++)l[s].setAttribute("role","columnheader");for(let s=0;s<r.length;s++)r[s].setAttribute("role","rowheader")}catch(a){console.log("my_calendar_table_aria(): "+a)}}w()})(jQuery);})();
