(()=>{(()=>{let{__:u,_x:P,_n:H,_nx:M}=wp.i18n;S(),h();function h(r=!1){let e=document.querySelectorAll(".mc-main, .mc-event-list");e&&e.forEach(a=>{let s=r||a.getAttribute("id");T(s),a.classList.remove("mcjs")})}let g=document.querySelectorAll(".mc-loader");g&&g.forEach(r=>{let e=r.closest("ul");e.setAttribute("tabindex","-1"),e.addEventListener("click",function(a){let s=a.target.closest("button");s&&s.classList.contains("mc-loader")&&x(s,e)})});function x(r,e){let a=new XMLHttpRequest;a.open("POST",my_calendar.ajaxurl,!0),a.setRequestHeader("Content-Type","application/x-www-form-urlencoded;"),a.onload=function(){if(this.status>=200&&this.status<400){let n=JSON.parse(this.response);e.querySelectorAll("li").forEach(t=>t.remove()),e.innerHTML+=n.response,e.focus(),wp.a11y.speak(u("Upcoming events loaded","my-calendar"))}else e.innerHTML+="<li>"+u("Upcoming Events failed to load","my-calendar")+"</li>",wp.a11y.speak(u("Upcoming Events failed to load","my-calendar"))},a.onerror=function(){};let s=r.value,c=r.getAttribute("data-value");type=s==="dates"?"dates":"time",a.send("action="+my_calendar.action+"&behavior=loadupcoming&"+type+"="+s+"&args="+c)}w(),q(),my_calendar.ajax==="true"&&(v(),A());function A(){document.querySelectorAll(".my-calendar-header a:not(.mc-print a, .mc-export a), .my-calendar-footer a:not(.mc-print a, .mc-export a), .my-calendar-header input[type=submit], .my-calendar-footer input[type=submit], .my-calendar-header button:not(.mc-export button), .my-calendar-footer button:not(.mc-export button)").forEach(e=>{e.addEventListener("click",function(a){_(a,e)}),e.addEventListener("keyup",function(a){_(a,e)})})}function _(r,e){if(r.preventDefault(),r.type==="click"||r.type==="keyup"&&r.key===" "){let a=e.closest(".mc-main");a.classList.remove("is-main-view");let s=e.getAttribute("id"),c=a.getAttribute("id"),n,t,i,p,y,d,f,m,l;if(e.nodeName==="INPUT"||e.nodeName==="BUTTON"){let o=e.closest("form");if(o){if(o.classList.contains("mc-date-switcher")){n=o.querySelector("select[name=month]").value;let b=o.querySelector("select[name=dy]");b&&(t=b.value),i=o.querySelector("select[name=yr]").value}o.classList.contains("mc-categories-switcher")&&(p=o.querySelector("select[name=mcat]").value),o.classList.contains("mc-locations-switcher")&&(y=o.querySelector("select[name=loc]").value),o.classList.contains("mc-access-switcher")&&(d=o.querySelector("select[name=access]").value),o.classList.contains("mc-search-form")&&(f=o.querySelector("input[name=mcs]").value),m=e.closest("form").getAttribute("action")}else m=e.getAttribute("data-href")}try{l=new URL(m),l.searchParams.delete("embed"),l.searchParams.delete("source"),(e.nodeName==="INPUT"||e.nodeName==="BUTTON")&&inputForm&&(l.searchParams.delete("month"),l.searchParams.delete("dy"),l.searchParams.delete("yr"),n!==""&&typeof n<"u"&&(l.searchParams.append("month",parseInt(n)),typeof t<"u"&&l.searchParams.append("dy",parseInt(t)),l.searchParams.append("yr",parseInt(i))),l.searchParams.delete("mcat"),p!==""&&typeof p<"u"&&l.searchParams.append("mcat",p),l.searchParams.delete("loc"),l.searchParams.delete("ltype"),y!==""&&typeof y<"u"&&(l.searchParams.append("ltype","id"),l.searchParams.append("loc",y)),l.searchParams.delete("access"),d!==""&&typeof d<"u"&&d!=="all"&&l.searchParams.append("access",parseInt(d)),l.searchParams.delete("mcs"),f!==""&&typeof f<"u"&&l.searchParams.append("mcs",encodeURIComponent(f)),m=l.toString()),window.history.pushState({},"",l)}catch(o){l=!1}a.insertAdjacentHTML("afterbegin",'<div class="mc-loading"></div><div class="loading"><span class="screen-reader-text">Loading...</span></div>'),wp.a11y.speak(u("Loading","my-calendar")),fetch(m).then(o=>{if(o.ok)return o.text()}).then(o=>{let k=new DOMParser().parseFromString(o,"text/html");a.replaceWith(k.querySelector("#"+c)),E(s,c)}).catch(o=>{a.insertAdjacentHTML("beforebegin",o)})}}function E(r,e){if(h(e),typeof my_calendar<"u"&&my_calendar.list=="true"){let c;my_calendar.links==="false"?(c=document.querySelectorAll("li.mc-events"),c.forEach(n=>{let t=n.querySelector(".mc-events");n.classList.contains("current-day")||(t.style.display="none")})):(c=document.querySelectorAll("li.mc-events .single-details"),c.forEach(n=>{n.style.display="none"}))}typeof my_calendar<"u"&&my_calendar.grid=="true"&&document.querySelectorAll(".mc-main.calendar .has-events > .calendar-event > *:not(header)").forEach(n=>{n.style.display="none"}),typeof my_calendar<"u"&&my_calendar.mini=="true"&&document.querySelectorAll(".mc-main.mini .has-events .calendar-events").forEach(n=>{n.style.display="none"}),w(),q(),document.getElementById(r).focus();let s=document.getElementById("mc_head_"+e);wp.a11y.speak(s.innerText),S(),my_calendar.ajax==="true"&&(v(),A()),L()}function S(){let r=document.querySelectorAll(".mc-user-time"),e=new Intl.DateTimeFormat().resolvedOptions().timeZone,a,s;r.forEach(c=>{let n=c.innerText,t=c.getAttribute("data-type");e===void 0&&(e=c.getAttribute("data-label")),t==="datetime"&&(s='<span class="mc-local-time-time">'+new Date(n).toLocaleTimeString().replace(":00 "," ")+"</span>",a='<span class="mc-local-time-date">'+new Date(n).toLocaleDateString()+"</span>",c.innerHTML='<span class="mc-local-time-label">'+e+":</span> "+a+'<span class="sep">, </span>'+s),t==="date"&&(a='<span class="mc-local-time-date">'+new Date(n).toLocaleDateString()+"</span>",c.innerHTML='<span class="mc-local-time-label">'+e+":</span> "+a),t==="time"&&(s='<span class="mc-local-time-time">'+new Date(n).toLocaleTimeString().replace(":00 "," ")+"</span>",c.innerHTML='<span class="mc-local-time-label">'+e+":</span> "+s),c.setAttribute("data-time",n)})}function v(){document.querySelectorAll(".my-calendar-header a:not(.mc-print a, .mc-export a), .my-calendar-footer a:not(.mc-print a, .mc-export a)").forEach(e=>{var s;let a=document.createElement("button");a.setAttribute("id",e.getAttribute("id")),a.setAttribute("data-href",e.getAttribute("href")),classes=(s=e.getAttribute("class"))!=null?s:"",a.setAttribute("class",classes),a.classList.add("mc-navigation-button"),a.setAttribute("type","button"),a.innerHTML=e.innerHTML,e.replaceWith(a)})}function T(r){if(r){let e=document.querySelector("#"+r+" .mc-subscribe"),a=document.querySelector("#"+r+" .mc-download");if(e!==null){let n="mc_control_"+Math.floor(Math.random()*1e3).toString(),t=document.createElement("button");t.setAttribute("type","button"),t.setAttribute("aria-controls",n),t.setAttribute("aria-expanded",!1),t.innerHTML=my_calendar.subscribe+' <span class="dashicons dashicons-arrow-right" aria-hidden="true"></span>',e.querySelector("ul").setAttribute("id",n),e.querySelector("ul").style.display="none",e.insertAdjacentElement("afterbegin",t)}if(a!==null){let n="mc_control_"+Math.floor(Math.random()*1e3).toString(),t=document.createElement("button");t.setAttribute("type","button"),t.setAttribute("aria-controls",n),t.setAttribute("aria-expanded",!1),t.innerHTML=my_calendar.export+' <span class="dashicons dashicons-arrow-right" aria-hidden="true"></span>',a.querySelector("ul").setAttribute("id",n),a.querySelector("ul").style.display="none",a.insertAdjacentElement("afterbegin",t)}let s=document.querySelectorAll("#"+r+" .mc-export button"),c;s.forEach(n=>{n.addEventListener("click",function(){let t=n.getAttribute("aria-controls"),i=document.getElementById(t);i&&(i.checkVisibility()?(i.style.display="none",n.setAttribute("aria-expanded","false"),c=n.querySelector(".dashicons"),c.classList.remove("dashicons-arrow-down"),c.classList.add("dashicons-arrow-right")):(i.style.display="block",n.setAttribute("aria-expanded","true"),c=n.querySelector(".dashicons"),c.classList.remove("dashicons-arrow-right"),c.classList.add("dashicons-arrow-down")))})})}}function w(){document.querySelectorAll(".mc-main a[target=_blank]").forEach(e=>{e.classList.add("mc-opens-in-new-tab"),e.insertAdjacentHTML("beforeend",' <span class="dashicons dashicons-external" aria-hidden="true"></span><span class="screen-reader-text"> '+my_calendar.newWindow+"</span>")})}function q(){let r=document.querySelectorAll(".mc-toggle-edit");r&&r.forEach(e=>{let a=e.getAttribute("aria-controls"),s=document.querySelector("#"+a);e.addEventListener("click",function(c){let n=e.offsetWidth+8;s.style.left=n+"px",e.getAttribute("aria-expanded")==="true"?(s.style.display="none",e.setAttribute("aria-expanded","false")):(s.style.display="block",e.setAttribute("aria-expanded","true"))})})}function L(){try{let r=document.querySelectorAll(".mc-main.calendar table.my-calendar-table"),e=document.querySelectorAll(".mc-main.calendar table.my-calendar-table thead, .mc-main.calendar table.my-calendar-table tbody, .mc-main.calendar table.my-calendar-table tfoot"),a=document.querySelectorAll(".mc-main.calendar table.my-calendar-table tr"),s=document.querySelectorAll(".mc-main.calendar table.my-calendar-table td"),c=document.querySelectorAll(".mc-main.calendar table.my-calendar-table th"),n=document.querySelectorAll(".mc-main.calendar table.my-calendar-table th[scope=row]");for(let t=0;t<r.length;t++)r[t].setAttribute("role","table");for(let t=0;t<e.length;t++)e[t].setAttribute("role","rowgroup");for(let t=0;t<a.length;t++)a[t].setAttribute("role","row");for(let t=0;t<s.length;t++)s[t].setAttribute("role","cell");for(let t=0;t<c.length;t++)c[t].setAttribute("role","columnheader");for(let t=0;t<n.length;t++)n[t].setAttribute("role","rowheader")}catch(r){console.log("my_calendar_table_aria(): "+r)}}L()})();})();
