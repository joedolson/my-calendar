(()=>{(()=>{let{__:p,_x:H,_n:M,_nx:j}=wp.i18n;S(),b();function b(r=!1){let e=document.querySelectorAll(".mc-main, .mc-event-list");e&&e.forEach(a=>{let c=r||a.getAttribute("id");P(c),a.classList.remove("mcjs")})}let g=document.querySelectorAll(".mc-loader");g&&g.forEach(r=>{let e=r.closest("ul");e.setAttribute("tabindex","-1"),e.addEventListener("click",function(a){let c=a.target.closest("button");c&&c.classList.contains("mc-loader")&&E(c,e)})});function E(r,e){let a=new XMLHttpRequest;a.open("POST",my_calendar.ajaxurl,!0),a.setRequestHeader("Content-Type","application/x-www-form-urlencoded;"),a.onload=function(){if(this.status>=200&&this.status<400){let n=JSON.parse(this.response);e.querySelectorAll("li").forEach(t=>t.remove()),e.innerHTML+=n.response,e.focus(),wp.a11y.speak(p("Upcoming events loaded","my-calendar"))}else e.innerHTML+="<li>"+p("Upcoming Events failed to load","my-calendar")+"</li>",wp.a11y.speak(p("Upcoming Events failed to load","my-calendar"))},a.onerror=function(){};let c=r.value,s=r.getAttribute("data-value");type=c==="dates"?"dates":"time",a.send("action="+my_calendar.action+"&behavior=loadupcoming&"+type+"="+c+"&args="+s)}w(),q(),my_calendar.ajax==="true"&&(v(),A());function A(){document.querySelectorAll(".my-calendar-header a:not(.mc-print a, .mc-export a), .my-calendar-footer a:not(.mc-print a, .mc-export a), .my-calendar-header input[type=submit], .my-calendar-footer input[type=submit], .my-calendar-header button:not(.mc-export button), .my-calendar-footer button:not(.mc-export button)").forEach(e=>{e.addEventListener("click",function(a){_(a,e)}),e.addEventListener("keyup",function(a){_(a,e)})})}function _(r,e){if(r.preventDefault(),r.type==="click"||r.type==="keyup"&&r.key===" "){let a=e.closest(".mc-main");a.classList.remove("is-main-view");let c=e.getAttribute("id"),s=a.getAttribute("id"),n,t,d,y,f,m,h,u,l,o,x;if(e.nodeName==="INPUT"||e.nodeName==="BUTTON")if(o=e.closest("form"),o){if(o.classList.contains("mc-date-switcher")){n=o.querySelector("select[name=month]").value;let i=o.querySelector("select[name=dy]");i&&(t=i.value),d=o.querySelector("select[name=yr]").value}o.classList.contains("mc-categories-switcher")&&(y=o.querySelector("select[name=mcat]").value),o.classList.contains("mc-locations-switcher")&&(f=o.querySelector("select[name=loc]").value),o.classList.contains("mc-access-switcher")&&(m=o.querySelector("select[name=access]").value),o.classList.contains("mc-search-form")&&(h=o.querySelector("input[name=mcs]").value),u=e.closest("form").getAttribute("action")}else u=e.getAttribute("data-href");try{l=new URL(u),l.searchParams.delete("embed"),l.searchParams.delete("source"),(e.nodeName==="INPUT"||e.nodeName==="BUTTON")&&(o=e.closest("form"),o&&(l.searchParams.delete("month"),l.searchParams.delete("dy"),l.searchParams.delete("yr"),n!==""&&typeof n<"u"&&(l.searchParams.append("month",parseInt(n)),typeof t<"u"&&l.searchParams.append("dy",parseInt(t)),l.searchParams.append("yr",parseInt(d))),l.searchParams.delete("mcat"),y!==""&&typeof y<"u"&&l.searchParams.append("mcat",y),l.searchParams.delete("loc"),l.searchParams.delete("ltype"),f!==""&&typeof f<"u"&&(l.searchParams.append("ltype","id"),l.searchParams.append("loc",f)),l.searchParams.delete("access"),m!==""&&typeof m<"u"&&m!=="all"&&l.searchParams.append("access",parseInt(m)),l.searchParams.delete("mcs"),h!==""&&typeof h<"u"&&l.searchParams.append("mcs",encodeURIComponent(h)),u=l.toString())),x=l.searchParams,x.sort(),window.history.pushState({},"",l)}catch(i){l=!1}a.insertAdjacentHTML("afterbegin",'<div class="mc-loading"></div><div class="loading"><span class="screen-reader-text">Loading...</span></div>'),wp.a11y.speak(p("Loading","my-calendar")),fetch(u).then(i=>{if(i.ok)return i.text()}).then(i=>{let k=new DOMParser().parseFromString(i,"text/html");a.replaceWith(k.querySelector("#"+s)),T(c,s)}).catch(i=>{a.insertAdjacentHTML("beforebegin",i)})}}function T(r,e){if(b(e),typeof my_calendar<"u"&&my_calendar.list=="true"){let s;my_calendar.links==="false"?(s=document.querySelectorAll("li.mc-events"),s.forEach(n=>{let t=n.querySelector(".mc-events");n.classList.contains("current-day")||(t.style.display="none")})):(s=document.querySelectorAll("li.mc-events .single-details"),s.forEach(n=>{n.style.display="none"}))}typeof my_calendar<"u"&&my_calendar.grid=="true"&&document.querySelectorAll(".mc-main.calendar .has-events > .calendar-event > *:not(header)").forEach(n=>{n.style.display="none"}),typeof my_calendar<"u"&&my_calendar.mini=="true"&&document.querySelectorAll(".mc-main.mini .has-events .calendar-events").forEach(n=>{n.style.display="none"}),w(),q(),document.getElementById(r).focus();let c=document.getElementById("mc_head_"+e);wp.a11y.speak(c.innerText),S(),my_calendar.ajax==="true"&&(v(),A()),L()}function S(){let r=document.querySelectorAll(".mc-user-time"),e=new Intl.DateTimeFormat().resolvedOptions().timeZone,a,c;r.forEach(s=>{let n=s.innerText,t=s.getAttribute("data-type");e===void 0&&(e=s.getAttribute("data-label")),t==="datetime"&&(c='<span class="mc-local-time-time">'+new Date(n).toLocaleTimeString().replace(":00 "," ")+"</span>",a='<span class="mc-local-time-date">'+new Date(n).toLocaleDateString()+"</span>",s.innerHTML='<span class="mc-local-time-label">'+e+":</span> "+a+'<span class="sep">, </span>'+c),t==="date"&&(a='<span class="mc-local-time-date">'+new Date(n).toLocaleDateString()+"</span>",s.innerHTML='<span class="mc-local-time-label">'+e+":</span> "+a),t==="time"&&(c='<span class="mc-local-time-time">'+new Date(n).toLocaleTimeString().replace(":00 "," ")+"</span>",s.innerHTML='<span class="mc-local-time-label">'+e+":</span> "+c),s.setAttribute("data-time",n)})}function v(){document.querySelectorAll(".my-calendar-header a:not(.mc-print a, .mc-export a), .my-calendar-footer a:not(.mc-print a, .mc-export a)").forEach(e=>{var c;let a=document.createElement("button");a.setAttribute("id",e.getAttribute("id")),a.setAttribute("data-href",e.getAttribute("href")),classes=(c=e.getAttribute("class"))!=null?c:"",a.setAttribute("class",classes),a.classList.add("mc-navigation-button"),a.setAttribute("type","button"),a.innerHTML=e.innerHTML,e.replaceWith(a)})}function P(r){if(r){let e=document.querySelector("#"+r+" .mc-subscribe"),a=document.querySelector("#"+r+" .mc-download");if(e!==null){let n="mc_control_"+Math.floor(Math.random()*1e3).toString(),t=document.createElement("button");t.setAttribute("type","button"),t.setAttribute("aria-controls",n),t.setAttribute("aria-expanded",!1),t.innerHTML=my_calendar.subscribe+' <span class="dashicons dashicons-arrow-right" aria-hidden="true"></span>',e.querySelector("ul").setAttribute("id",n),e.querySelector("ul").style.display="none",e.insertAdjacentElement("afterbegin",t)}if(a!==null){let n="mc_control_"+Math.floor(Math.random()*1e3).toString(),t=document.createElement("button");t.setAttribute("type","button"),t.setAttribute("aria-controls",n),t.setAttribute("aria-expanded",!1),t.innerHTML=my_calendar.export+' <span class="dashicons dashicons-arrow-right" aria-hidden="true"></span>',a.querySelector("ul").setAttribute("id",n),a.querySelector("ul").style.display="none",a.insertAdjacentElement("afterbegin",t)}let c=document.querySelectorAll("#"+r+" .mc-export button"),s;c.forEach(n=>{n.addEventListener("click",function(){let t=n.getAttribute("aria-controls"),d=document.getElementById(t);d&&(d.checkVisibility()?(d.style.display="none",n.setAttribute("aria-expanded","false"),s=n.querySelector(".dashicons"),s.classList.remove("dashicons-arrow-down"),s.classList.add("dashicons-arrow-right")):(d.style.display="block",n.setAttribute("aria-expanded","true"),s=n.querySelector(".dashicons"),s.classList.remove("dashicons-arrow-right"),s.classList.add("dashicons-arrow-down")))})})}}function w(){document.querySelectorAll(".mc-main a[target=_blank]").forEach(e=>{e.classList.add("mc-opens-in-new-tab"),e.insertAdjacentHTML("beforeend",' <span class="dashicons dashicons-external" aria-hidden="true"></span><span class="screen-reader-text"> '+my_calendar.newWindow+"</span>")})}function q(){let r=document.querySelectorAll(".mc-toggle-edit");r&&r.forEach(e=>{let a=e.getAttribute("aria-controls"),c=document.querySelector("#"+a);e.addEventListener("click",function(s){let n=e.offsetWidth+8;c.style.left=n+"px",e.getAttribute("aria-expanded")==="true"?(c.style.display="none",e.setAttribute("aria-expanded","false")):(c.style.display="block",e.setAttribute("aria-expanded","true"))})})}function L(){try{let r=document.querySelectorAll(".mc-main.calendar table.my-calendar-table"),e=document.querySelectorAll(".mc-main.calendar table.my-calendar-table thead, .mc-main.calendar table.my-calendar-table tbody, .mc-main.calendar table.my-calendar-table tfoot"),a=document.querySelectorAll(".mc-main.calendar table.my-calendar-table tr"),c=document.querySelectorAll(".mc-main.calendar table.my-calendar-table td"),s=document.querySelectorAll(".mc-main.calendar table.my-calendar-table th"),n=document.querySelectorAll(".mc-main.calendar table.my-calendar-table th[scope=row]");for(let t=0;t<r.length;t++)r[t].setAttribute("role","table");for(let t=0;t<e.length;t++)e[t].setAttribute("role","rowgroup");for(let t=0;t<a.length;t++)a[t].setAttribute("role","row");for(let t=0;t<c.length;t++)c[t].setAttribute("role","cell");for(let t=0;t<s.length;t++)s[t].setAttribute("role","columnheader");for(let t=0;t<n.length;t++)n[t].setAttribute("role","rowheader")}catch(r){console.log("my_calendar_table_aria(): "+r)}}L()})();})();
